<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style type="text/css">
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
</style>
    <meta charset="utf-8">
    <meta name="google" content="notranslate">
    <meta http-equiv="Content-Language" content="en">

    <title>IOWA - Linear regression (Revised) - Databricks Community Edition</title>
  <link rel="shortcut icon" href="https://community.cloud.databricks.com/favicon.ico"><link href="IOWA%20-%20Linear%20regression%20(Revised)%20-%20Databricks%20Community%20Edition_files/main.css" rel="stylesheet"><link href="IOWA%20-%20Linear%20regression%20(Revised)%20-%20Databricks%20Community%20Edition_files/print.css" rel="stylesheet" media="print"><style data-emotion=""></style><style id="plotly.js-style-global"></style><style data-emotion="css"></style><style id="detectElementResize" type="text/css">@keyframes resizeanim { from { opacity: 0; } to { opacity: 0; } } .resize-triggers { animation: 1ms resizeanim; visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }</style></head>
  <body class="light-mode notebook-present">
    <noscript>
      You need to enable JavaScript to run this app.
    </noscript>

    <!-- TODO: Eventually remove `uses-legacy-bootstrap` and fix UI. Refer to epic: PROD-20453  -->
    <uses-legacy-bootstrap data-wrapped-element-id="toolbar">
      <div id="toolbar"></div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="tooltip">
      <div id="tooltip" class="hidden">
        <p><span id="value"></span></p>
      </div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="global-notification-container">
      <div id="global-notification-container"><div class="databricks-notification-wrapper"><div class="notifications-wrapper"></div></div></div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="topbar">
      <div id="topbar" style="">
        <div class="tb-title-wrapper tb-title-wrapper-central" style="left: 76px;">
          <span class="tb-title"><span class="notebook-title-wrapper"><span id="nbTitle">IOWA - Linear regression (Revised)</span></span></span>
          <span class="tb-title-portal"></span>
          <span class="tb-title-lang"><a class="tb-lang-link" data-lang="python">(Python)</a></span>
          <div class="tb-status">
            <span class="tb-status-msg tb-status-msg-error"></span>
            <span class="tb-status-msg tb-status-msg-banner"></span>
            <span class="tb-status-msg tb-status-msg-locked"></span>
            <span class="tb-status-msg tb-status-msg-connecting">Connecting...&nbsp;</span>
            <span class="tb-status-msg tb-status-msg-waiting">Still working...&nbsp;</span>
            <img class="tb-status-spinner" src="IOWA%20-%20Linear%20regression%20(Revised)%20-%20Databricks%20Community%20Edition_files/spinner.gif" alt="spinner">
          </div>
        </div>
        <a class="tb-button tb-button-right tb-button-user" title="Account">
          <i class="fa fa-user fa-lg no-workspace-name-icon"></i>
          <div class="workspace-name-icon-wrapper hidden btn">
            <span class="workspace-name"></span>
            <i class="fa fa-user fa-lg"></i>
          </div>
        </a>
        <a class="tb-button tb-button-right tb-button-help" title="Help and Support">
          <i class="fa fa-question fa-lg"></i>
        </a>
        <a class="tb-button tb-button-right tb-button-upgrade" title="Upgrade" target="_blank">
          <span> <i class="fa fa-arrow-circle-up"></i>Upgrade </span>
        </a>
        <div class="tb-title-wrapper tb-title-wrapper-right">
          <div class="tb-trial-msg"></div>
          <div class="tb-title-icons tb-title-icons-right"></div>
          <div class="tb-status presence">
            <span class="tb-status-msg tb-status-presence" style=""><!-- presenceTemplate -->

<ul class="noselect">
  
  <li title="Recent Activity" class="presence-history">
    <div><i class="fa fa-clock-o"></i></div>
  </li>
</ul>

</span>
          </div>
        </div>
      </div>
    </uses-legacy-bootstrap>

    <div id="sidebar-and-notebook">
      <uses-legacy-bootstrap data-wrapped-element-id="sidebar">
        <div id="sidebar" class="sidebar"><div class="sidebar-outer sidebar--theme-unified"><div class="sidebar-main" data-panel="Workspace"><ul class="sidebar-ul"><li class="sidebar-element-wrapper sidebar-element-wrapper--logo"><a href="#" class="sidebar-element" data-name="Databricks"><div class="sidebar-element-icon"><div class="sidebar-databricks-logo"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 105 113"><path d="M0 29.44v3.4l52.13 29.41 46.56-26.29.01 10.62-46.57 26.46L2.62 44.91 0 46.37v20.35l52.13 29.34 46.56-26.2.01 10.54-46.57 26.46L2.62 78.73 0 80.19v3.45l52.13 29.33 52.13-29.33V63.27l-2.63-1.45-49.5 28.13L5.56 63.49V53l46.57 26.17 52.13-29.34V29.76l-2.63-1.46-49.5 28.14L7.95 31.33 52.13 6.38l36.39 20.56 3.18-1.79v-2.8L52.13 0z" fill="currentColor" fill-rule="nonzero"></path></svg></span></div></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element" data-name="Home"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 20 22" fill="none"><path d="M10 1.757l8.611 6.694V20.14h-4.583v-8.903H5.972v8.903H1.39V8.459L10 1.756zM10 0L0 7.778v13.75h7.361v-8.903h5.278v8.903H20V7.778L10 0z" fill="currentColor"></path></svg></span></div></div><div><span class="sidebar-label">Home</span></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element selected" data-name="Workspace"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 32 32"><path fill="currentColor" d="M28.818 2.21c.541 0 .972.442.972.972v25.47a.974.974 0 01-.972.972H5.558V2.21h23.26zm0-2.21H3.348v31.834h25.47A3.182 3.182 0 0032 28.652V3.182A3.182 3.182 0 0028.818 0z"></path><path fill="none" stroke="currentColor" stroke-width="2.4" d="M10.287 0v31.823"></path><path fill="none" stroke="currentColor" stroke-width="3.2" d="M0 7.293h10.287M0 23.856h10.287M0 15.58h10.287"></path></svg></span></div></div><div><span class="sidebar-label">Workspace</span></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element" data-name="Recents"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 34 32"><path fill="currentColor" d="M16.821 2c7.618 0 13.816 6.28 13.816 14S24.44 30 16.821 30C9.203 30 3.005 23.72 3.005 16S9.202 2 16.821 2zm0-2C8.097 0 1.032 7.16 1.032 16s7.066 16 15.789 16c8.724 0 15.79-7.16 15.79-16S25.545 0 16.821 0z"></path><path stroke="currentColor" stroke-width="2.4" d="M16.821 6.4V16l6.316 3.2"></path></svg></span></div></div><div><span class="sidebar-label">Recents</span></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element" data-name="Tables"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 20 20" fill="none"><path d="M4.323 0a4.323 4.323 0 100 8.646 4.323 4.323 0 000-8.646zm0 7.355A3.029 3.029 0 011.29 4.323 3.029 3.029 0 014.323 1.29a3.029 3.029 0 013.032 3.033 3.029 3.029 0 01-3.032 3.032zM19.29.13h-8.387v8.322h8.323V.129h.064zM18 7.225h-5.742V1.484H18v5.742zM15.097 10.774L10.258 20H20l-4.903-9.226zm0 2.774l2.71 5.162h-5.484l2.774-5.162zM7.742 11.29l-3.42 3.42-3.354-3.42-.968.904 3.42 3.419L0 19.033l.968.902 3.355-3.419 3.419 3.42.903-.904-3.42-3.42 3.42-3.418-.903-.904z" fill="currentColor"></path></svg></span></div></div><div><span class="sidebar-label">Data</span></div></a></li><li class="sidebar-element-wrapper"><a href="#setting/clusters" class="sidebar-element" data-name="Clusters"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 33 32"><path fill="none" stroke-width="2.182" stroke="currentColor" d="M16.728 13.603v10.188M5.712 23.606V20.73c0-1.443 1.155-2.613 2.578-2.613h16.876c1.424 0 2.579 1.17 2.579 2.613v2.876"></path><path fill="none" stroke-linejoin="round" stroke-linecap="round" stroke-width="2.182" stroke="currentColor" d="M2.845 16.459a4.513 4.513 0 01-.471-2.028c0-2.554 2.049-4.631 4.57-4.631h1.453c.01-4.612 3.695-8.346 8.245-8.346 3.57 0 6.6 2.291 7.764 5.509h1.52c1.684 0 3.262.829 4.224 2.213a5.277 5.277 0 01-.414 6.513"></path><path fill="none" stroke-width="2.182" stroke="currentColor" d="M5.713 30.459c1.817 0 3.291-1.493 3.291-3.334s-1.473-3.334-3.291-3.334-3.29 1.493-3.29 3.334 1.473 3.334 3.29 3.334zM16.728 30.459c1.817 0 3.29-1.493 3.29-3.334s-1.473-3.334-3.29-3.334-3.291 1.493-3.291 3.334 1.473 3.334 3.291 3.334zM27.754 30.459c1.817 0 3.29-1.493 3.29-3.334s-1.473-3.334-3.29-3.334-3.291 1.493-3.291 3.334 1.473 3.334 3.291 3.334z"></path></svg></span></div></div><div><span class="sidebar-label">Clusters</span></div></a></li><li class="sidebar-element-wrapper"><a href="#joblist" class="sidebar-element" data-name="Jobs"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 39 32"><path fill="none" stroke-width="3.556" stroke="currentColor" d="M15.934 5.586h22.078M15.934 17.814h22.078M3.372 30.031h34.64M11.854 1.778L6.085 7.624 2.924 4.421M11.854 14.006l-5.769 5.846-3.161-3.203"></path></svg></span></div></div><div><span class="sidebar-label">Jobs</span></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element" data-name="Search"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 34 32"><path fill="currentColor" d="M14.051 1.862c6.194 0 11.231 5.104 11.231 11.381s-5.037 11.38-11.231 11.38S2.82 19.519 2.82 13.243 7.857 1.862 14.051 1.862zm0-1.862C6.836 0 .982 5.932.982 13.243s5.854 13.243 13.069 13.243c7.215 0 13.069-5.932 13.069-13.243S21.266 0 14.051 0z"></path><path fill="none" stroke="currentColor" stroke-width="3.048" d="M31.058 30.486l-8.217-8.336"></path></svg></span></div></div><div><span class="sidebar-label">Search</span></div></a></li></ul></div><div class="sidebar-alt"><div></div></div></div></div>
      </uses-legacy-bootstrap>

      <div id="overallView" style="left: 76px;" class="new-notebook"><div style="height: 100%;"><uses-legacy-bootstrap data-wrapped-element-id="ReactNotebookView"><div class="databricks-notification-wrapper"><div class="notifications-wrapper"></div></div><div class="new-notebook context-bar" id="context-bar"><div class="context-bar__left"><div class="attach-cluster-select-wrapper"><i class="fa fa-sitemap" style="text-align: center;"></i><div class="control-field clusters attach-cluster-select css-wwrqjh-container"><div class="react-select__control css-ay0o3m-control"><div class="react-select__value-container css-12n3d9a"><div class="react-select__placeholder css-1wa3eu0-placeholder">Detached</div><div class="css-92gm0r"><div class="react-select__input" style="display: inline-block;"><input autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-2-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" aria-label="Select Cluster" style="box-sizing: content-box; width: 2px; background: rgba(0, 0, 0, 0) none repeat scroll 0px center; border: 0px none; font-size: inherit; opacity: 1; outline: currentcolor none 0px; padding: 0px; color: inherit;"><div style="position: absolute; top: 0px; left: 0px; visibility: hidden; height: 0px; overflow: scroll; white-space: pre; font-size: 13px; font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-weight: 400; font-style: normal; letter-spacing: normal; text-transform: none;"></div></div></div></div><div class="react-select__indicators css-1wy0on6"><span class="react-select__indicator-separator css-1okebmr-indicatorSeparator"></span><div aria-hidden="true" class="react-select__indicator react-select__dropdown-indicator css-1kh17bq-indicatorContainer"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-19bqh2r"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div></div></div><div class="dropdown actions-dropdown"><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="actions-dropdown-link" data-name="File"><i class="fa fa-file-text-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">File</span> <i class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="tooltip-react-content" style="left: 10px; top: 26px; width: 300px;"><div class="tooltip-react-arrow" style="left: 36.5px;"></div><div class="tooltip-react-inner"></div></div></div></div><div class="dropdown edit-dropdown"><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="edit-dropdown-link" data-name="Edit"><i class="fa fa-edit contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Edit</span> <i class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="tooltip-react-content" style="left: 10px; top: 26px; width: 300px;"><div class="tooltip-react-arrow" style="left: 37.8834px;"></div><div class="tooltip-react-inner"></div></div></div></div><div class="dropdown view-dropdown"><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="view-mode-link" data-name="View: Standard"><i class="fa fa-picture-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">View: Standard</span> <i class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="tooltip-react-content" style="left: 10px; top: 26px; width: 300px;"><div class="tooltip-react-arrow" style="left: 70.8915px;"></div><div class="tooltip-react-inner"></div></div></div></div><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="no-click context-bar-item permissions" id="share" data-name="Permissions" disabled=""><i class="fa fa-lock contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Permissions</span></a></div></div><div class="tooltip-react-content" style="left: 446.225px; top: 26px; width: 300px;"><div class="tooltip-react-arrow" style="left: 150px;"></div><div class="tooltip-react-inner"></div></div></div><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="0.8256051381817566" data-name="Run All"><i class="fa fa-play-circle-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Run All</span></a></div></div><div class="tooltip-react-content" style="left: 541.1px; top: 26px; width: 300px;"><div class="tooltip-react-arrow" style="left: 150px;"></div><div class="tooltip-react-inner"></div></div></div><div class="dropdown clear-dropdown"><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="clear-results-link" data-name="Clear"><i class="fa fa-eraser contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Clear</span> <i class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="tooltip-react-content" style="left: 10px; top: 26px; width: 300px;"><div class="tooltip-react-arrow" style="left: 42.9334px;"></div><div class="tooltip-react-inner"></div></div></div></div></div><div class="context-bar__right"><div class="context-bar-right-links"><div id="shortcut-wrapper"><a class="shortcut-menu-icon"><i class="fa fa-keyboard-o" style="text-align: center;"></i></a></div><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="publish-notebook" data-name="Publish"><i class="fa fa-share-square-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Publish</span></a></div></div><div class="tooltip-react-content" style="left: 857.967px; top: 21.5833px; width: 300px;"><div class="tooltip-react-arrow" style="left: 150px;"></div><div class="tooltip-react-inner"></div></div></div><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="show-comments" data-name="Comments"><i class="fa fa-comments contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Comments</span></a></div></div><div class="tooltip-react-content" style="left: 951.867px; top: 21.5833px; width: 300px;"><div class="tooltip-react-arrow" style="left: 150px;"></div><div class="tooltip-react-inner"></div></div></div><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="view-mlflow-runs" data-name="Experiment"><span><span><i class="fa fa-flask contextBarIcon--js" style="text-align: center;"></i></span></span><span class="context-bar-link-text">Experiment</span></a></div></div><div class="tooltip-react-content" style="left: 1055.95px; top: 21.5833px; width: 227.05px;"><div class="tooltip-react-arrow" style="left: 1205.95px;"></div><div class="tooltip-react-inner"></div></div></div><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="show-history" data-name="Revision history"><i class="fa fa-history contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Revision history</span></a></div></div><div class="tooltip-react-content" style="left: 1174.18px; top: 21.5833px; width: 122.817px;"><div class="tooltip-react-arrow" style="left: 1324.18px;"></div><div class="tooltip-react-inner"></div></div></div></div></div></div><div id="content" class="new-notebook"><section class="ant-layout ant-layout-has-sider notebook-view" style="height: 100%; background-color:var(--primary-background-color);"><aside class="notebook-table-of-contents-sidebar ant-layout-sider ant-layout-sider-light ant-layout-sider-collapsed ant-layout-sider-zero-width" style="flex: 0 0 0px; max-width: 0px; min-width: 0px; width: 0px;"><div class="ant-layout-sider-children"><div class="ant-tree notebook-table-of-contents-content ant-tree-icon-hide ant-tree-block-node"><div role="tree"><input style="width: 0px; height: 0px; display: flex; overflow: hidden; opacity: 0; border: 0px none; padding: 0px; margin: 0px;" tabindex="0"></div><div class="ant-tree-list"><div><div style="display: flex; flex-direction: column;" class="ant-tree-list-holder-inner"><div class="ant-tree-treenode ant-tree-treenode-switcher-open ant-tree-treenode-leaf-last"><span class="ant-tree-switcher ant-tree-switcher_open"><span role="img" aria-label="caret-down" class="anticon anticon-caret-down ant-tree-switcher-icon"><svg viewBox="0 0 1024 1024" focusable="false" class="" data-icon="caret-down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"></path></svg></span></span><span title="" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-open"><span class="ant-tree-title"><span style="font-weight: bold;">IOWA - Linear Regression (Revised)</span></span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-start"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="TODO 0: Run the code in PySpark CLI" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">TODO 0: Run the code in PySpark CLI</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="Load the Data to the table" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">Load the Data to the table</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-close"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="Using Vector Assembler and Standard Scaler" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">Using Vector Assembler and Standard Scaler</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="Define the Pipeline and Train the Model" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">Define the Pipeline and Train the Model</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="Tune Parameters" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">Tune Parameters</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="Test the Model" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">Test the Model</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="Examine the Predicted and Actual Values" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">Examine the Predicted and Actual Values</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="data visualization using SQL in Databricks." class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">data visualization using SQL in Databricks.</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="TODO 1: Visualize the following sql as scatter plot. " class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">TODO 1: Visualize the following sql as scatter plot. </span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open ant-tree-treenode-leaf-last"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-end"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="Retrieve the Root Mean Square Error (RMSE)" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">Retrieve the Root Mean Square Error (RMSE)</span></span></div></div></div></div></div></div><span class="ant-layout-sider-zero-width-trigger ant-layout-sider-zero-width-trigger-left"><i class="fa fa-angle-right" style="text-align: center;"></i></span></aside><main class="ant-layout-content"><div id="notebook-input-widget-panel" class="input-widget-panel empty pinned"><ul></ul><div class="widget-panel-settings"><i class="fa fa-cog settings" style="cursor: pointer; text-align: center;"></i><i class="fa fa-thumb-tack pinning pinned" style="cursor: pointer; text-align: center;"></i></div></div><div class="new-notebook overallContainer" style="margin-top: 0px;"><div class="sessionPane"></div><div class="has-headings shell-top new-notebook"><img alt="Loading..." class="load-spinner" src="IOWA%20-%20Linear%20regression%20(Revised)%20-%20Databricks%20Community%20Edition_files/spinner.svg"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158569"><i class="fa fa-link" style="text-align: center;"></i>Cmd 1</a><div class="new-notebook command mainCommand command-finished cellIndex-0 cell-4428881799158568-4428881799158569"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-0 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-0 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 50px; left: 203.8px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 74px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 173.8px; top: 38px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">%md ## IOWA - Linear Regression (Revised)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-header cm-header-3">### Paper Publication</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 74px;"></div><div class="CodeMirror-gutters" style="left: 0px; height: 89px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="26e95dff-e007-4450-8c02-7c59925b066f"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>IOWA - Linear Regression (Revised)</h2>
<h3>Paper Publication</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158570"><i class="fa fa-link" style="text-align: center;"></i>Cmd 2</a><div class="new-notebook command mainCommand command-finished cellIndex-1 cell-4428881799158568-4428881799158570"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-1 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-1 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>Import</span><span> </span><span>the</span><span> </span><span>Libraries</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>First,</span><span> </span><span>import</span><span> </span><span>the</span><span> </span><span>libraries</span><span> </span><span>you</span><span> </span><span>will</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>create</span><span> </span><span>the</span><span> </span><span>dataframe</span><span> </span><span>and</span><span> </span><span>make</span><span> </span><span>a</span><span> </span><span>sample</span><span> </span><span>out</span><span> </span><span>of</span><span> </span><span>it.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="0671946e-699f-49c8-82f9-1f2222aa8422"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>Import the Libraries</h2>
<p>First, import the libraries you will need to create the dataframe and make a sample out of it.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158571"><i class="fa fa-link" style="text-align: center;"></i>Cmd 3</a><div class="new-notebook command mainCommand command-finished cellIndex-2 cell-4428881799158568-4428881799158571"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-2 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 392px; left: 118px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off">from pyspark.sql.types import *
from pyspark.sql.functions import *

from pyspark.ml import Pipeline
from pyspark.ml.regression import LinearRegression
from pyspark.ml.feature import VectorAssembler
from pyspark.ml.tuning import ParamGridBuilder, CrossValidator, TrainValidationSplit
from pyspark.ml.evaluation import RegressionEvaluator


from pyspark.context import SparkContext
from pyspark.sql.session import SparkSession</textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 435px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 88px; top: 380px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-comment"># Import Spark SQL and Spark ML libraries</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">sql</span>.<span class="cm-property">types</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">sql</span>.<span class="cm-property">functions</span> <span class="cm-keyword">import</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">context</span> <span class="cm-keyword">import</span> <span class="cm-variable">SparkContext</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">sql</span>.<span class="cm-property">session</span> <span class="cm-keyword">import</span> <span class="cm-variable">SparkSession</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">sql</span> <span class="cm-keyword">import</span> <span class="cm-variable">SQLContext</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">sqlContext</span> <span class="cm-operator">=</span> <span class="cm-variable">SQLContext</span>(<span class="cm-variable">sc</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span> <span class="cm-keyword">import</span> <span class="cm-variable">Pipeline</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">storagelevel</span> <span class="cm-keyword">import</span> <span class="cm-variable">StorageLevel</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">feature</span> <span class="cm-keyword">import</span> <span class="cm-variable">VectorAssembler</span>, <span class="cm-variable">StandardScaler</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">tuning</span> <span class="cm-keyword">import</span> <span class="cm-variable">CrossValidator</span>, <span class="cm-variable">ParamGridBuilder</span>, <span class="cm-variable">TrainValidationSplit</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">regression</span> <span class="cm-keyword">import</span> <span class="cm-variable">DecisionTreeRegressor</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">regression</span> <span class="cm-keyword">import</span> <span class="cm-variable">GBTRegressor</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">evaluation</span> <span class="cm-keyword">import</span> <span class="cm-variable">RegressionEvaluator</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">sql</span> <span class="cm-keyword">import</span> <span class="cm-variable">functions</span> <span class="cm-keyword">as</span> <span class="cm-variable">f</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">import</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">sql</span>.<span class="cm-property">functions</span> <span class="cm-keyword">as</span> <span class="cm-variable">f</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">import</span> <span class="cm-variable">sys</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 435px;"></div><div class="CodeMirror-gutters" style="height: 449px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158572"><i class="fa fa-link" style="text-align: center;"></i>Cmd 4</a><div class="new-notebook command mainCommand command-finished cellIndex-3 cell-4428881799158568-4428881799158572"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-3 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-3 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>#</span><span> </span><span>TODO</span><span> </span><span>0</span><span>:</span><span> </span><span>Run</span><span> </span><span>the</span><span> </span><span>code</span><span> </span><span>in</span><span> </span><span>PySpark</span><span> </span><span>CLI</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Set</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">following</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">True</span><span class="cm-variable-2">:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-comment">```</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-comment">PYSPARK_CLI = True</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-comment">```</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">You</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">need</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">generate</span><span class="cm-variable-2"> </span><span class="cm-variable-2">py</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">Python)</span><span class="cm-variable-2"> </span><span class="cm-variable-2">file</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">File</span><span class="cm-variable-2"> </span><span class="cm-variable-2">&gt;</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Export</span><span class="cm-variable-2"> </span><span class="cm-variable-2">&gt;</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Source</span><span class="cm-variable-2"> </span><span class="cm-variable-2">File</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Run</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">it</span><span class="cm-variable-2"> </span><span class="cm-variable-2">at</span><span class="cm-variable-2"> </span><span class="cm-variable-2">your</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Hadoop/Spark</span><span class="cm-variable-2"> </span><span class="cm-variable-2">cluster</span><span class="cm-variable-2">:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-comment">```</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-comment">$ spark-submit Python_Creating_Project_Sample_Data.py</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-comment">```</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="a07fbb40-4361-4270-97c6-71cc124afcde"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>TODO 0: Run the code in PySpark CLI</h3>
<ol>
<li>Set the following to True:<pre><code>PYSPARK_CLI = True
</code></pre></li>
<li>You need to generate py (Python) file: File &gt; Export &gt; Source File</li>
<li>Run it at your Hadoop/Spark cluster:<pre><code>$ spark-submit Python_Creating_Project_Sample_Data.py
</code></pre></li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158573"><i class="fa fa-link" style="text-align: center;"></i>Cmd 5</a><div class="new-notebook command mainCommand command-finished cellIndex-4 cell-4428881799158568-4428881799158573"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-4 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">PYSPARK_CLI</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-keyword">False</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-keyword">if</span><span> </span><span class="cm-variable">PYSPARK_CLI</span><span>:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>    </span><span class="cm-variable">sc</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">SparkContext</span><span>.</span><span class="cm-property">getOrCreate</span><span>(</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>    </span><span class="cm-variable">spark</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">SparkSession</span><span>(</span><span class="cm-variable">sc</span><span>)</span></pre></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.02 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158574"><i class="fa fa-link" style="text-align: center;"></i>Cmd 6</a><div class="new-notebook command mainCommand command-finished cellIndex-5 cell-4428881799158568-4428881799158574"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-5 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 373px; left: 281.8px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 530px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>27</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 251.8px; top: 361px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-comment"># DataFrame Schema</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">liquorsalesSchema</span> <span class="cm-operator">=</span> <span class="cm-variable">StructType</span>([</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"Invoice/Item Number"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"Date"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"StoreNumber"</span>, <span class="cm-variable">IntegerType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"StoreName"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"Address"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"City"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"ZipCode"</span>, <span class="cm-variable">IntegerType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"StoreLocation"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"CountyNumber"</span>, <span class="cm-variable">IntegerType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"County"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"Category"</span>, <span class="cm-variable">IntegerType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"CategoryName"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"VendorNumber"</span>, <span class="cm-variable">IntegerType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"VendorName"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"ItemNumber"</span>, <span class="cm-variable">IntegerType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"ItemDescription"</span>, <span class="cm-variable">StringType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"Pack"</span>, <span class="cm-variable">IntegerType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"BottleVolumeInMl"</span>, <span class="cm-variable">IntegerType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"StateBottleCost"</span>, <span class="cm-variable">DoubleType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"StateBottleRetail"</span>, <span class="cm-variable">DoubleType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"BottlesSold"</span>, <span class="cm-variable">IntegerType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"SaleInDollars"</span>, <span class="cm-variable">DoubleType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"VolumeSoldInLitres"</span>,<span class="cm-variable">DoubleType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp;<span class="cm-variable">StructField</span>(<span class="cm-string">"VolumeSoldInGallons"</span>, <span class="cm-variable">DoubleType</span>(), <span class="cm-keyword">False</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">])</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 530px;"></div><div class="CodeMirror-gutters" style="height: 544px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158575"><i class="fa fa-link" style="text-align: center;"></i>Cmd 7</a><div class="new-notebook command mainCommand command-finished cellIndex-6 cell-4428881799158568-4428881799158575"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-6 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-6 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>#</span><span> </span><span>Load</span><span> </span><span>the</span><span> </span><span>Data</span><span> </span><span>to</span><span> </span><span>the</span><span> </span><span>table</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="a8dcf534-0ef0-414e-a811-6ab32cab978b"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Load the Data to the table</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158576"><i class="fa fa-link" style="text-align: center;"></i>Cmd 8</a><div class="new-notebook command mainCommand command-finished cellIndex-7 cell-4428881799158568-4428881799158576"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-7 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 31px; left: 289.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 188px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 259.6px; top: 19px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">if</span> <span class="cm-variable">PYSPARK_CLI</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp; &nbsp;<span class="cm-variable">csv</span> <span class="cm-operator">=</span> <span class="cm-variable">spark</span>.<span class="cm-property">read</span>.<span class="cm-property">csv</span>(<span class="cm-string">'sample.csv'</span>, <span class="cm-variable">inferSchema</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>, <span class="cm-variable">header</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-keyword">else</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"> &nbsp; <span class="cm-variable">csv</span> <span class="cm-operator">=</span> <span class="cm-variable">spark</span>.<span class="cm-property">sql</span>(<span class="cm-string">"SELECT * FROM sample_csv"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-comment"># Load the source data</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-comment"># csv = spark.read.csv('wasb:///data/iowa_Liquor_Sales.csv', inferSchema=True, header=True)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">csv</span>.<span class="cm-property">show</span>(<span class="cm-variable">truncate</span> <span class="cm-operator">=</span> <span class="cm-keyword">False</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 188px;"></div><div class="CodeMirror-gutters" style="height: 202px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.73 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158577"><i class="fa fa-link" style="text-align: center;"></i>Cmd 9</a><div class="new-notebook command mainCommand command-finished cellIndex-8 cell-4428881799158568-4428881799158577"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-8 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-8 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>Select</span><span> </span><span>features</span><span> </span><span>and</span><span> </span><span>label</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Select</span><span> </span><span>the</span><span> </span><span>relevant</span><span> </span><span>columns</span><span> </span><span>in</span><span> </span><span>a</span><span> </span><span>new</span><span> </span><span>dataframe</span><span> </span><span>and</span><span> </span><span>define</span><span> </span><span>the</span><span> </span><span>label.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="c826aaff-56c1-49c9-aa00-719b93308b83"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>Select features and label</h2>
<h4>Select the relevant columns in a new dataframe and define the label.</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158578"><i class="fa fa-link" style="text-align: center;"></i>Cmd 10</a><div class="new-notebook command mainCommand command-finished cellIndex-9 cell-4428881799158568-4428881799158578"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-9 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 242.8px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"># Select features and label</textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 207px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 212.8px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-comment"># Select relevant columns.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">csv1</span> <span class="cm-operator">=</span> <span class="cm-variable">csv</span>.<span class="cm-property">select</span>(<span class="cm-string">"Pack"</span>, <span class="cm-string">"BottleVolumeInMl"</span>, <span class="cm-string">"StateBottleCost"</span>, <span class="cm-string">"StateBottleRetail"</span>, <span class="cm-string">"BottlesSold"</span>, <span class="cm-string">"SaleInDollars"</span>, <span class="cm-string">"VolumeSoldInLitres"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df1</span> <span class="cm-operator">=</span> <span class="cm-variable">csv1</span>.<span class="cm-property">filter</span>(<span class="cm-variable">csv1</span>.<span class="cm-property">StateBottleCost</span>.<span class="cm-property">isNotNull</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df2</span> <span class="cm-operator">=</span> <span class="cm-variable">df1</span>.<span class="cm-property">filter</span>(<span class="cm-variable">df1</span>.<span class="cm-property">StateBottleRetail</span>.<span class="cm-property">isNotNull</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df3</span> <span class="cm-operator">=</span> <span class="cm-variable">df2</span>.<span class="cm-property">filter</span>(<span class="cm-variable">df2</span>.<span class="cm-property">BottleVolumeInMl</span>.<span class="cm-property">isNotNull</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df4</span> <span class="cm-operator">=</span> <span class="cm-variable">df3</span>.<span class="cm-property">filter</span>(<span class="cm-variable">df3</span>.<span class="cm-property">Pack</span>.<span class="cm-property">isNotNull</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df5</span> <span class="cm-operator">=</span> <span class="cm-variable">df4</span>.<span class="cm-property">filter</span>(<span class="cm-variable">df4</span>.<span class="cm-property">BottlesSold</span>.<span class="cm-property">isNotNull</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df6</span> <span class="cm-operator">=</span> <span class="cm-variable">df5</span>.<span class="cm-property">filter</span>(<span class="cm-variable">df5</span>.<span class="cm-property">SaleInDollars</span>.<span class="cm-property">isNotNull</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df7</span> <span class="cm-operator">=</span> <span class="cm-variable">df6</span>.<span class="cm-property">filter</span>(<span class="cm-variable">df6</span>.<span class="cm-property">VolumeSoldInLitres</span>.<span class="cm-property">isNotNull</span>())</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="height: 221px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.35 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158594"><i class="fa fa-link" style="text-align: center;"></i>Cmd 11</a><div class="new-notebook command mainCommand command-input cellIndex-10 cell-4428881799158568-4428881799158594"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-10 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-input"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 131px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-comment"># Select features and label</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">df7</span>.<span class="cm-property">select</span>(<span class="cm-variable">col</span>(<span class="cm-string">"Pack"</span>).<span class="cm-property">cast</span>(<span class="cm-variable">DoubleType</span>()), <span class="cm-variable">col</span>(<span class="cm-string">"BottleVolumeInMl"</span>).<span class="cm-property">cast</span>(<span class="cm-variable">DoubleType</span>()), <span class="cm-string">"StateBottleCost"</span>, <span class="cm-string">"StateBottleRetail"</span>, <span class="cm-variable">col</span>(<span class="cm-string">"BottlesSold"</span>).<span class="cm-property">cast</span>(<span class="cm-variable">DoubleType</span>()), <span class="cm-string">"VolumeSoldInLitres"</span>, <span class="cm-variable">col</span>(<span class="cm-string">"SaleInDollars"</span>).<span class="cm-property">alias</span>(<span class="cm-string">"label"</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">data</span>.<span class="cm-property">persist</span>(<span class="cm-variable">StorageLevel</span>.<span class="cm-property">DISK_ONLY</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">data</span>.<span class="cm-property">show</span>(<span class="cm-number">5</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 131px;"></div><div class="CodeMirror-gutters" style="height: 145px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158579"><i class="fa fa-link" style="text-align: center;"></i>Cmd 12</a><div class="new-notebook command mainCommand command-finished cellIndex-11 cell-4428881799158568-4428881799158579"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-11 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-11 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>Split</span><span> </span><span>the</span><span> </span><span>data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Split</span><span> </span><span>the</span><span> </span><span>data</span><span> </span><span>in</span><span> </span><span>70-30</span><span> </span><span>train-test</span><span> </span><span>ratio.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="a9011797-e73b-4952-8b82-9bbf87f4da86"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>Split the data</h2>
<h4>Split the data in 70-30 train-test ratio.</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158580"><i class="fa fa-link" style="text-align: center;"></i>Cmd 13</a><div class="new-notebook command mainCommand command-finished cellIndex-12 cell-4428881799158568-4428881799158580"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-12 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 202px; left: 149.2px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 226px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>11</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 119.2px; top: 190px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-comment"># Split the data</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">splits</span> <span class="cm-operator">=</span> <span class="cm-variable">data</span>.<span class="cm-property">randomSplit</span>([<span class="cm-number">0.7</span>, <span class="cm-number">0.3</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">train</span> <span class="cm-operator">=</span> <span class="cm-variable">splits</span>[<span class="cm-number">0</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">test</span> <span class="cm-operator">=</span> <span class="cm-variable">splits</span>[<span class="cm-number">1</span>].<span class="cm-property">withColumnRenamed</span>(<span class="cm-string">"label"</span>, <span class="cm-string">"trueLabel"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">train</span>.<span class="cm-property">persist</span>(<span class="cm-variable">StorageLevel</span>.<span class="cm-property">DISK_ONLY</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">test</span>.<span class="cm-property">persist</span>(<span class="cm-variable">StorageLevel</span>.<span class="cm-property">DISK_ONLY</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-builtin">print</span> (<span class="cm-string">"Training Rows:"</span>, <span class="cm-variable">train</span>.<span class="cm-property">count</span>(), <span class="cm-string">"Testing Rows:"</span>, <span class="cm-variable">test</span>.<span class="cm-property">count</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">train</span>.<span class="cm-property">show</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-number">20</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 226px;"></div><div class="CodeMirror-gutters" style="height: 240px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158595"><i class="fa fa-link" style="text-align: center;"></i>Cmd 14</a><div class="new-notebook command mainCommand command-input cellIndex-13 cell-4428881799158568-4428881799158595"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-13 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-13 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-input"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 71.2px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: -16px; border-right-width: 14px; min-height: 55px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 41.2px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation">%md ### Using Vector Assembler and Standard Scaler</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 55px;"></div><div class="CodeMirror-gutters" style="height: 69px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="67d72ef7-d272-42d0-97db-175c89f2aaac"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Using Vector Assembler and Standard Scaler</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158596"><i class="fa fa-link" style="text-align: center;"></i>Cmd 15</a><div class="new-notebook command mainCommand command-input cellIndex-14 cell-4428881799158568-4428881799158596"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-14 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-input"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 468px; left: 40px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 492px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like">x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 10px; top: 456px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">assembler</span> <span class="cm-operator">=</span> <span class="cm-variable">VectorAssembler</span>(<span class="cm-variable">inputCols</span> <span class="cm-operator">=</span> [<span class="cm-string">"Pack"</span>, <span class="cm-string">"BottleVolumeInMl"</span>,<span class="cm-string">"StateBottleCost"</span>, <span class="cm-string">"StateBottleRetail"</span>, <span class="cm-string">"BottlesSold"</span>, <span class="cm-string">"VolumeSoldInLitres"</span>], <span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">"features"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">temp_train</span> <span class="cm-operator">=</span> <span class="cm-variable">assembler</span>.<span class="cm-property">transform</span>(<span class="cm-variable">train</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">temp_train</span>.<span class="cm-property">persist</span>(<span class="cm-variable">StorageLevel</span>.<span class="cm-property">DISK_ONLY</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">standardScaler</span> <span class="cm-operator">=</span> <span class="cm-variable">StandardScaler</span>(<span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">"features"</span>, <span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">"scaled"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">lr_train</span> <span class="cm-operator">=</span> <span class="cm-variable">standardScaler</span>.<span class="cm-property">fit</span>(<span class="cm-variable">temp_train</span>).<span class="cm-property">transform</span>(<span class="cm-variable">temp_train</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">lr_train</span>.<span class="cm-property">persist</span>(<span class="cm-variable">StorageLevel</span>.<span class="cm-property">DISK_ONLY</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df_train</span> <span class="cm-operator">=</span> <span class="cm-variable">lr_train</span>.<span class="cm-property">select</span>(<span class="cm-string">"label"</span>, <span class="cm-string">"scaled"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df_train</span>.<span class="cm-property">persist</span>(<span class="cm-variable">StorageLevel</span>.<span class="cm-property">DISK_ONLY</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">temp_test</span> <span class="cm-operator">=</span> <span class="cm-variable">assembler</span>.<span class="cm-property">transform</span>(<span class="cm-variable">test</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">temp_test</span>.<span class="cm-property">persist</span>(<span class="cm-variable">StorageLevel</span>.<span class="cm-property">DISK_ONLY</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">lr_test</span> <span class="cm-operator">=</span> <span class="cm-variable">standardScaler</span>.<span class="cm-property">fit</span>(<span class="cm-variable">temp_test</span>).<span class="cm-property">transform</span>(<span class="cm-variable">temp_test</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">lr_test</span>.<span class="cm-property">persist</span>(<span class="cm-variable">StorageLevel</span>.<span class="cm-property">DISK_ONLY</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df_test</span> <span class="cm-operator">=</span> <span class="cm-variable">lr_test</span>.<span class="cm-property">select</span>(<span class="cm-string">"trueLabel"</span>, <span class="cm-string">"scaled"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">df_test</span>.<span class="cm-property">persist</span>(<span class="cm-variable">StorageLevel</span>.<span class="cm-property">DISK_ONLY</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 492px;"></div><div class="CodeMirror-gutters" style="height: 506px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158581"><i class="fa fa-link" style="text-align: center;"></i>Cmd 16</a><div class="new-notebook command mainCommand command-finished cellIndex-15 cell-4428881799158568-4428881799158581"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-15 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-15 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>#</span><span> </span><span>Define</span><span> </span><span>the</span><span> </span><span>Pipeline</span><span> </span><span>and</span><span> </span><span>Train</span><span> </span><span>the</span><span> </span><span>Model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Now</span><span> </span><span>define</span><span> </span><span>a</span><span> </span><span>pipeline</span><span> </span><span>that</span><span> </span><span>creates</span><span> </span><span>a</span><span> </span><span>feature</span><span> </span><span>vector</span><span> </span><span>and</span><span> </span><span>trains</span><span> </span><span>a</span><span> </span><span>regression</span><span> </span><span>model</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="6fd77234-79bc-48d1-8f36-8126a3572df8"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Define the Pipeline and Train the Model</h3>
<p>Now define a pipeline that creates a feature vector and trains a regression model</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158582"><i class="fa fa-link" style="text-align: center;"></i>Cmd 17</a><div class="new-notebook command mainCommand command-finished cellIndex-16 cell-4428881799158568-4428881799158582"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-16 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 107px; left: 289.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off">pipeline = Pipeline(stages=[assembler, lr])</textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 150px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 259.6px; top: 95px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-comment"># Define the pipeline</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-comment">#lr = LinearRegression(labelCol="label", featuresCol="features", maxIter=10, regParam=0.3)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">lr</span> <span class="cm-operator">=</span> <span class="cm-variable">LinearRegression</span>(<span class="cm-variable">labelCol</span><span class="cm-operator">=</span><span class="cm-string">"label"</span>, <span class="cm-variable">featuresCol</span><span class="cm-operator">=</span><span class="cm-string">"scaled"</span>, <span class="cm-variable">maxIter</span><span class="cm-operator">=</span><span class="cm-number">10</span>, <span class="cm-variable">regParam</span><span class="cm-operator">=</span><span class="cm-number">.01</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">pipeline</span> <span class="cm-operator">=</span> <span class="cm-variable">Pipeline</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">stages</span><span class="cm-operator">=</span>[<span class="cm-variable">lr</span>]<span class=" CodeMirror-matchingbracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 150px;"></div><div class="CodeMirror-gutters" style="height: 164px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.07 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158583"><i class="fa fa-link" style="text-align: center;"></i>Cmd 18</a><div class="new-notebook command mainCommand command-finished cellIndex-17 cell-4428881799158568-4428881799158583"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-17 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-17 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>#</span><span> </span><span>Tune</span><span> </span><span>Parameters</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>You</span><span> </span><span>can</span><span> </span><span>tune</span><span> </span><span>parameters</span><span> </span><span>to</span><span> </span><span>find</span><span> </span><span>the</span><span> </span><span>best</span><span> </span><span>model</span><span> </span><span>for</span><span> </span><span>your</span><span> </span><span>data.</span><span> </span><span>A</span><span> </span><span>simple</span><span> </span><span>way</span><span> </span><span>to</span><span> </span><span>do</span><span> </span><span>this</span><span> </span><span>is</span><span> </span><span>to</span><span> </span><span>use</span><span> </span><span> </span><span class="cm-strong">**</span><span class="cm-strong">TrainValidationSplit</span><span class="cm-strong">**</span><span> </span><span>to</span><span> </span><span>evaluate</span><span> </span><span>each</span><span> </span><span>combination</span><span> </span><span>of</span><span> </span><span>parameters</span><span> </span><span>defined</span><span> </span><span>in</span><span> </span><span>a</span><span> </span><span class="cm-strong">**</span><span class="cm-strong">ParameterGrid</span><span class="cm-strong">**</span><span> </span><span>against</span><span> </span><span>a</span><span> </span><span>subset</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>training</span><span> </span><span>data</span><span> </span><span>in</span><span> </span><span>order</span><span> </span><span>to</span><span> </span><span>find</span><span> </span><span>the</span><span> </span><span>best</span><span> </span><span>performing</span><span> </span><span>parameters.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-header header-4">#### </span><span class="cm-header header-4">Regularization</span><span class="cm-header header-4"> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>is</span><span> </span><span>a</span><span> </span><span>way</span><span> </span><span>of</span><span> </span><span>avoiding</span><span> </span><span>Imbalances</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>way</span><span> </span><span>that</span><span> </span><span>the</span><span> </span><span>data</span><span> </span><span>is</span><span> </span><span>trained</span><span> </span><span>against</span><span> </span><span>the</span><span> </span><span>training</span><span> </span><span>data</span><span> </span><span>so</span><span> </span><span>that</span><span> </span><span>the</span><span> </span><span>model</span><span> </span><span>ends</span><span> </span><span>up</span><span> </span><span>being</span><span> </span><span>over</span><span> </span><span>fit</span><span> </span><span>to</span><span> </span><span>the</span><span> </span><span>training</span><span> </span><span>data.</span><span> </span><span>In</span><span> </span><span>other</span><span> </span><span>words</span><span> </span><span>It</span><span> </span><span>works</span><span> </span><span>really</span><span> </span><span>well</span><span> </span><span>with</span><span> </span><span>the</span><span> </span><span>training</span><span> </span><span>data</span><span> </span><span>but</span><span> </span><span>it</span><span> </span><span>doesn</span><span>'</span><span>t</span><span> </span><span>generalize</span><span> </span><span>well</span><span> </span><span>with</span><span> </span><span>other</span><span> </span><span>data.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span>That</span><span> </span><span>we</span><span> </span><span>can</span><span> </span><span>use</span><span> </span><span>a</span><span> </span><span class="cm-strong">**</span><span class="cm-strong">regularization</span><span class="cm-strong"> </span><span class="cm-strong">parameter</span><span class="cm-strong">**</span><span> </span><span>to</span><span> </span><span>vary</span><span> </span><span>the</span><span> </span><span>way</span><span> </span><span>that</span><span> </span><span>the</span><span> </span><span>model</span><span> </span><span>balances</span><span> </span><span>that</span><span> </span><span>way.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-header header-4">#### </span><span class="cm-header header-4">Training</span><span class="cm-header header-4"> </span><span class="cm-header header-4">ratio</span><span class="cm-header header-4"> </span><span class="cm-header header-4">of</span><span class="cm-header header-4"> </span><span class="cm-header header-4">0.8</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span>it</span><span>'</span><span>s</span><span> </span><span>going</span><span> </span><span>to</span><span> </span><span>use</span><span> </span><span>80%</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>the</span><span> </span><span>data</span><span> </span><span>that</span><span> </span><span>it</span><span>'</span><span>s</span><span> </span><span>got</span><span> </span><span>in</span><span> </span><span>its</span><span> </span><span>training</span><span> </span><span>set</span><span> </span><span>to</span><span> </span><span>train</span><span> </span><span>the</span><span> </span><span>model</span><span> </span><span>and</span><span> </span><span>then</span><span> </span><span>the</span><span> </span><span>remaining</span><span> </span><span>20%</span><span> </span><span>is</span><span> </span><span>going</span><span> </span><span>to</span><span> </span><span>use</span><span> </span><span>to</span><span> </span><span>validate</span><span> </span><span>the</span><span> </span><span>trained</span><span> </span><span>model.</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span>In</span><span> </span><span class="cm-strong">**</span><span class="cm-strong">ParamGridBuilder</span><span class="cm-strong">**</span><span>,</span><span> </span><span>all</span><span> </span><span>possible</span><span> </span><span>combinations</span><span> </span><span>are</span><span> </span><span>generated</span><span> </span><span>from</span><span> </span><span>regParam,</span><span> </span><span>maxIter.</span><span> </span><span>So</span><span> </span><span>it</span><span> </span><span>is</span><span> </span><span>going</span><span> </span><span>to</span><span> </span><span>try</span><span> </span><span>each</span><span> </span><span>combination</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>parameters</span><span> </span><span>with</span><span> </span><span>80%</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>the</span><span> </span><span>data</span><span> </span><span>to</span><span> </span><span>train</span><span> </span><span>the</span><span> </span><span>model</span><span> </span><span>and</span><span> </span><span>20%</span><span> </span><span>to</span><span> </span><span>to</span><span> </span><span>validate</span><span> </span><span>it.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="4d6d2988-5f6a-4f50-a589-2c5eb50dd6a3"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Tune Parameters</h3>
<p>You can tune parameters to find the best model for your data. A simple way to do this is to use  <strong>TrainValidationSplit</strong> to evaluate each combination of parameters defined in a <strong>ParameterGrid</strong> against a subset of the training data in order to find the best performing parameters.</p>
<h4>Regularization</h4>
<p>is a way of avoiding Imbalances in the way that the data is trained 
against the training data so that the model ends up being over fit to 
the training data. In other words It works really well with the training
 data but it doesn't generalize well with other data.
That we can use a <strong>regularization parameter</strong> to vary the way that the model balances that way.</p>
<h4>Training ratio of 0.8</h4>
<p>it's going to use 80% of the the data that it's got in its training 
set to train the model and then the remaining 20% is going to use to 
validate the trained model. </p>
<p>In <strong>ParamGridBuilder</strong>, all possible combinations are 
generated from regParam, maxIter. So it is going to try each combination
 of the parameters with 80% of the the data to train the model and 20% 
to to validate it.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158584"><i class="fa fa-link" style="text-align: center;"></i>Cmd 19</a><div class="new-notebook command mainCommand command-finished cellIndex-18 cell-4428881799158568-4428881799158584"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-18 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 88px; left: 258.4px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 112px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 228.4px; top: 76px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">paramGrid_tvs</span> <span class="cm-operator">=</span> <span class="cm-variable">ParamGridBuilder</span>().<span class="cm-property">addGrid</span>(<span class="cm-variable">lr</span>.<span class="cm-property">regParam</span>, [<span class="cm-number">0.3</span>, <span class="cm-number">0.1</span>, <span class="cm-number">0.01</span>]).<span class="cm-property">addGrid</span>(<span class="cm-variable">lr</span>.<span class="cm-property">maxIter</span>, [<span class="cm-number">10</span>, <span class="cm-number">5</span>]).<span class="cm-property">build</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">tvs</span> <span class="cm-operator">=</span> <span class="cm-variable">TrainValidationSplit</span>(<span class="cm-variable">estimator</span><span class="cm-operator">=</span><span class="cm-variable">pipeline</span>, <span class="cm-variable">evaluator</span><span class="cm-operator">=</span><span class="cm-variable">RegressionEvaluator</span>(), <span class="cm-variable">estimatorParamMaps</span><span class="cm-operator">=</span><span class="cm-variable">paramGrid_tvs</span>, <span class="cm-variable">trainRatio</span><span class="cm-operator">=</span><span class="cm-number">0.8</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">lr_model</span> <span class="cm-operator">=</span> <span class="cm-variable">tvs</span>.<span class="cm-property">fit</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">df_train</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 112px;"></div><div class="CodeMirror-gutters" style="height: 126px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>30.33 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158585"><i class="fa fa-link" style="text-align: center;"></i>Cmd 20</a><div class="new-notebook command mainCommand command-finished cellIndex-19 cell-4428881799158568-4428881799158585"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-19 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-19 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>#</span><span> </span><span>Test</span><span> </span><span>the</span><span> </span><span>Model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Now</span><span> </span><span>you</span><span>'</span><span>re</span><span> </span><span>ready</span><span> </span><span>to</span><span> </span><span>apply</span><span> </span><span>the</span><span> </span><span>model</span><span> </span><span>to</span><span> </span><span>the</span><span> </span><span>test</span><span> </span><span>data.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="ddef426e-b9fc-46c0-8353-f952561d6614"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Test the Model</h3>
<p>Now you're ready to apply the model to the test data.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158586"><i class="fa fa-link" style="text-align: center;"></i>Cmd 21</a><div class="new-notebook command mainCommand command-finished cellIndex-20 cell-4428881799158568-4428881799158586"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-20 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 69px; left: 203.8px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 93px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 173.8px; top: 57px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">lr_prediction</span> <span class="cm-operator">=</span> <span class="cm-variable">lr_model</span>.<span class="cm-property">transform</span>(<span class="cm-variable">df_test</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">lr_predicted</span> <span class="cm-operator">=</span> <span class="cm-variable">lr_prediction</span>.<span class="cm-property">select</span>(<span class="cm-string">"scaled"</span>, <span class="cm-string">"prediction"</span>, <span class="cm-string">"trueLabel"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">lr_predicted</span>.<span class="cm-property">show</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-number">10</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 93px;"></div><div class="CodeMirror-gutters" style="height: 107px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.82 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158587"><i class="fa fa-link" style="text-align: center;"></i>Cmd 22</a><div class="new-notebook command mainCommand command-finished cellIndex-21 cell-4428881799158568-4428881799158587"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-21 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-21 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>#</span><span> </span><span>Examine</span><span> </span><span>the</span><span> </span><span>Predicted</span><span> </span><span>and</span><span> </span><span>Actual</span><span> </span><span>Values</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="0721ac5d-e475-418d-8ec4-bc406bfd29c7"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Examine the Predicted and Actual Values</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158588"><i class="fa fa-link" style="text-align: center;"></i>Cmd 23</a><div class="new-notebook command mainCommand command-finished cellIndex-22 cell-4428881799158568-4428881799158588"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-22 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">predicted</span><span>.</span><span class="cm-property">createOrReplaceTempView</span><span>(</span><span class="cm-string">"regressionPredictions"</span><span>)</span></pre></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.05 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158589"><i class="fa fa-link" style="text-align: center;"></i>Cmd 24</a><div class="new-notebook command mainCommand command-finished cellIndex-23 cell-4428881799158568-4428881799158589"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-23 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-23 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>#</span><span> </span><span>data</span><span> </span><span>visualization</span><span> </span><span>using</span><span> </span><span>SQL</span><span> </span><span>in</span><span> </span><span>Databricks.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="04999bfe-cabf-4bf9-8285-1cfe1f407944"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>data visualization using SQL in Databricks.</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158590"><i class="fa fa-link" style="text-align: center;"></i>Cmd 25</a><div class="new-notebook command mainCommand command-finished cellIndex-24 cell-4428881799158568-4428881799158590"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-24 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-24 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>#</span><span> </span><span>TODO</span><span> </span><span>1</span><span>:</span><span> </span><span>Visualize</span><span> </span><span>the</span><span> </span><span>following</span><span> </span><span>sql</span><span> </span><span>as</span><span> </span><span>scatter</span><span> </span><span>plot.</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Then,</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">select</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">icon</span><span class="cm-variable-2"> </span><span class="cm-variable-2">graph</span><span class="cm-variable-2"> </span><span class="cm-variable-2">"</span><span class="cm-variable-2">Show</span><span class="cm-variable-2"> </span><span class="cm-variable-2">in</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Dashboard</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Menu</span><span class="cm-variable-2">"</span><span class="cm-variable-2"> </span><span class="cm-variable-2">in</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">right</span><span class="cm-variable-2"> </span><span class="cm-variable-2">top</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">cell</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">create</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Dashboard</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Select</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">"</span><span class="cm-variable-2">+Add</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">New</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Dashboard</span><span class="cm-variable-2">"</span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">will</span><span class="cm-variable-2"> </span><span class="cm-variable-2">move</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">new</span><span class="cm-variable-2"> </span><span class="cm-variable-2">web</span><span class="cm-variable-2"> </span><span class="cm-variable-2">page</span><span class="cm-variable-2"> </span><span class="cm-variable-2">with</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">scatter</span><span class="cm-variable-2"> </span><span class="cm-variable-2">plot</span><span class="cm-variable-2"> </span><span class="cm-variable-2">chart</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Name</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">dashboard</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-strong variable-2">__</span><span class="cm-strong variable-2">Regression</span><span class="cm-strong variable-2"> </span><span class="cm-strong variable-2">Evaluation</span><span class="cm-strong variable-2">__</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-strong">__</span><span class="cm-strong">NOTEL</span><span class="cm-strong">__</span><span>:</span><span> </span><span class="cm-em">_</span><span class="cm-em">%sql</span><span class="cm-em">_</span><span> </span><span>does</span><span> </span><span>not</span><span> </span><span>work</span><span> </span><span>at</span><span> </span><span>PySpark</span><span> </span><span>CLI</span><span> </span><span>but</span><span> </span><span>only</span><span> </span><span>at</span><span> </span><span>Databricks</span><span> </span><span>notebook.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="37f24041-13e4-4c64-86c9-ec2cfcbf4d39"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>TODO 1: Visualize the following sql as scatter plot.</h3>
<ol>
<li>Then, select the icon graph "Show in Dashboard Menu" in the right top of the cell to create a Dashboard</li>
<li>Select "+Add to New Dashboard" and will move to new web page with the scatter plot chart</li>
<li>Name the dashboard to <strong>Regression Evaluation</strong></li>
</ol>
<p><strong>NOTEL</strong>: <em>%sql</em> does not work at PySpark CLI but only at Databricks notebook.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158591"><i class="fa fa-link" style="text-align: center;"></i>Cmd 26</a><div class="new-notebook command mainCommand command-finished cellIndex-25 cell-4428881799158568-4428881799158591"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="dashboard-button dashboard-button-25 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-25 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span>sql</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-keyword">SELECT</span><span> </span><span>trueLabel</span><span class="cm-punctuation">,</span><span> </span><span>prediction</span><span> </span><span class="cm-keyword">FROM</span><span> </span><span>regressionPredictions</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>0.53 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="cursor: pointer; text-align: center;"></i></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158592"><i class="fa fa-link" style="text-align: center;"></i>Cmd 27</a><div class="new-notebook command mainCommand command-finished cellIndex-26 cell-4428881799158568-4428881799158592"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-26 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-26 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span><span>#</span><span>#</span><span>#</span><span> </span><span>Retrieve</span><span> </span><span>the</span><span> </span><span>Root</span><span> </span><span>Mean</span><span> </span><span>Square</span><span> </span><span>Error</span><span> </span><span>(</span><span>RMSE)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>There</span><span> </span><span>are</span><span> </span><span>a</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>metrics</span><span> </span><span>used</span><span> </span><span>to</span><span> </span><span>measure</span><span> </span><span>the</span><span> </span><span>variance</span><span> </span><span>between</span><span> </span><span>predicted</span><span> </span><span>and</span><span> </span><span>actual</span><span> </span><span>values.</span><span> </span><span>Of</span><span> </span><span>these,</span><span> </span><span>the</span><span> </span><span>root</span><span> </span><span>mean</span><span> </span><span>square</span><span> </span><span>error</span><span> </span><span>(</span><span>RMSE)</span><span> </span><span>is</span><span> </span><span>a</span><span> </span><span>commonly</span><span> </span><span>used</span><span> </span><span>value</span><span> </span><span>that</span><span> </span><span>is</span><span> </span><span>measured</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>same</span><span> </span><span>units</span><span> </span><span>as</span><span> </span><span>the</span><span> </span><span>predicted</span><span> </span><span>and</span><span> </span><span>actual</span><span> </span><span>values</span><span> </span><span>-</span><span> </span><span>so</span><span> </span><span>in</span><span> </span><span>this</span><span> </span><span>case,</span><span> </span><span>the</span><span> </span><span>RMSE</span><span> </span><span>indicates</span><span> </span><span>the</span><span> </span><span>average</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>minutes</span><span> </span><span>between</span><span> </span><span>predicted</span><span> </span><span>and</span><span> </span><span>actual</span><span> </span><span>flight</span><span> </span><span>delay</span><span> </span><span>values.</span><span> </span><span>You</span><span> </span><span>can</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span class="cm-strong">**</span><span class="cm-strong">RegressionEvaluator</span><span class="cm-strong">**</span><span> </span><span>class</span><span> </span><span>to</span><span> </span><span>retrieve</span><span> </span><span>the</span><span> </span><span>RMSE.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" style="left: 0px; top: 0px; width: auto; height: auto;" data-guid="c95768d4-5d20-4699-b8df-7e128c869972"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Retrieve the Root Mean Square Error (RMSE)</h3>
<p>There are a number of metrics used to measure the variance between 
predicted and actual values. Of these, the root mean square error (RMSE)
 is a commonly used value that is measured in the same units as the 
predicted and actual values - so in this case, the RMSE indicates the 
average number of minutes between predicted and actual flight delay 
values. You can use the <strong>RegressionEvaluator</strong> class to retrieve the RMSE.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="#notebook/4428881799158568/command/4428881799158593"><i class="fa fa-link" style="text-align: center;"></i>Cmd 28</a><div class="new-notebook command mainCommand command-active command-focused is-editing command-finished cellIndex-27 cell-4428881799158568-4428881799158593"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-play fa-fw" style="text-align: center;"></i><i class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-27 command-button" title="Edit Menu"><i class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt primaryPrompt"><div class="command-text command-text-edit command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap CodeMirror-focused"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: currentcolor none medium;" autocorrect="off" autocapitalize="none" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" wrap="off"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -16px; border-right-width: 14px; min-height: 74px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div style="position: relative; outline: currentcolor none medium;" role="presentation"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">evaluator_lr</span> <span class="cm-operator">=</span> <span class="cm-variable">RegressionEvaluator</span>(<span class="cm-variable">labelCol</span><span class="cm-operator">=</span><span class="cm-string">"trueLabel"</span>, <span class="cm-variable">predictionCol</span><span class="cm-operator">=</span><span class="cm-string">"prediction"</span>, <span class="cm-variable">metricName</span><span class="cm-operator">=</span><span class="cm-string">"rmse"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-variable">rmse</span> <span class="cm-operator">=</span> <span class="cm-variable">evaluator_lr</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">lr_prediction</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation"><span class="cm-builtin">print</span> (<span class="cm-string">"Root Mean Square Error (RMSE):"</span>, <span class="cm-variable">rmse</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 14px; width: 1px; border-bottom: 0px solid transparent; top: 74px;"></div><div class="CodeMirror-gutters" style="height: 88px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><a class="show-result-link">Show result</a><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="command-result-stats hidden"><span>Command took</span> <span>2.15 seconds</span> <span class="command-provenance">-- by apaul11@calstatela.edu</span><span> at 5/7/2020, 2:01:05 PM</span><span> on unknown cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="submit-hint">Shift+Enter to run &nbsp;&nbsp;&nbsp;<a class="shortcuts-link" title="View keyboard shortcuts">shortcuts</a></div><div class="contentSpacer" style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; height: 0px;"></div><div style="min-height: 328.5px;"></div></div><div class="notebook-footer"></div></div></main></section><div id="selection-popover" style="top: 316.367px; left: 1311px;" class="hidden add-comment"><a class="btn btn-default btn-circle"><i class="fa fa-comment-o fa-fw css-20rwj2" style="text-align: center;"></i></a></div></div></uses-legacy-bootstrap></div></div>
    </div>

    <uses-legacy-bootstrap data-wrapped-element-id="filebrowser-popup">
      <div id="filebrowser-popup" style="display: none;">
        <div class="filebrowser-header">Workspace</div>
        <div class="filebrowser filetree" style="display: none; width: 266px;" data-state="invisible" data-history-size="30"><div class="inner"><div class="ft-panel ui-droppable ui-resizable" style="width: 266px;" data-panel="Workspace"><ul class="ft-panel-list"><li class="filetree-list-item top-link has-menu"><a href="#" class="filetree-link" title="Workspace"><i class="fa fa-databricks-does-not-exist fa-fw"></i><span class="filetree-display-name">Workspace</span><div class="dropdown"><i class="fa fa-chevron-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="#" class="filetree-link ui-droppable" title="Shared"><i class="fa fa-share-alt-square fa-fw"></i><span class="filetree-display-name">Shared</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="#" class="filetree-link ui-droppable" title="Users"><i class="fa fa-users fa-fw"></i><span class="filetree-display-name">Users</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li></ul><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div></div></div>
      <a class="ft-pin-button" href="#" title="Pin side panels"></a><a class="ft-scroll-angle-left hidden" href="#" title="Scroll to left"><i class="fa fa-angle-left"></i></a><a class="ft-scroll-angle-right hidden" href="#" title="Scroll to right"><i class="fa fa-angle-right"></i></a></div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="projects-filebrowser-popup">
      <div id="projects-filebrowser-popup" style="display: none;">
        <div class="filebrowser-header">
          Projects
          <a class="btn btn-secondary create-project">Create Project</a>
        </div>
        <div class="filebrowser" style="display: none;"></div>
      </div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="searchpanel-popup">
      <div id="searchpanel-popup">
        <div class="searchpanel ui-resizable" data-panel="Search" style="display: none;" data-state="invisible"><div class="search-panel-content"><a class="ft-pin-button" title="Pin side panels"></a><div class="newsearch"><input title="Search Workspace" class="newsearch searchbox" type="text" placeholder="Search Workspace"><span class="search-mixin-spinner"><i class="fa fa-spinner fa-spin" style="text-align: center;"></i></span></div><ul></ul></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div>
      </div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="title-menu">
      <div id="title-menu" class="tb-title-menu dropdown-menu" role="menu"></div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="user-menu">
      <div id="user-menu" class="dropdown-menu"><div class="user-menu-view"><div class="account-section"><div class="header" title="apaul11@calstatela.edu">Signed in as <br><b>apaul11@calstatela.edu</b></div><ul><li><a href="#setting/account" class="accounts-link settings-button"><div class="accounts-text">User Settings</div></a></li><li><a href="#setting/accounts" class="accounts-link admin-console-button"><div class="accounts-text">Admin Console</div></a></li><li><a href="https://accounts.cloud.databricks.com/registration.html#login" class="accounts-link manage-account-button"><div class="accounts-text">Manage Account</div></a></li><li><a href="#setting/logout" class="accounts-link logout-button"><div class="accounts-text">Log Out</div></a></li></ul></div><hr><div><div class="org-section"><div class="header">Workspaces</div><ul class="confirmed-workspaces"><li><a class="workspace-link" data-name="CSULA" target="_blank" title="CSULA (apaul11@calstatela.edu)"><div class="workspace-item"><div class="workspace-text"><div class="icon"><i class="fa fa-check"></i></div><div class="workspace-name">CSULA</div></div><div class="workspace-owner">apaul11@calstatela.edu</div></div></a></li></ul></div></div></div></div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="dropdown-menu">
      <ul id="help-menu" class="dropdown-menu newhelp"><div><div class="input"><i class="fa fa-search fa-fw" style="text-align: center;"></i><input title="Search" class="newsearch" type="text" placeholder="Search"><span class="search-mixin-spinner"><i class="fa fa-spinner fa-spin" style="text-align: center;"></i></span></div><ul style="max-height: 544.25px;"><li class="result"><a href="https://help.databricks.com/" class="" title="Help Center"><i class="fa fa- fa-fw"></i><span>Help Center</span></a></li><li class="result"><a href="https://docs.databricks.com/release-notes/" class="" title="Release Notes"><i class="fa fa- fa-fw"></i><span>Release Notes</span></a></li><li class="result"><a href="https://docs.databricks.com/" class="" title="Documentation"><i class="fa fa- fa-fw"></i><span>Documentation</span></a></li><li class="result"><a href="https://kb.databricks.com/" class="" title="Knowledge Base"><i class="fa fa- fa-fw"></i><span>Knowledge Base</span></a></li><li class="result"><a href="mailto:feedback@databricks.com" class="" title="Feedback"><i class="fa fa- fa-fw"></i><span>Feedback</span></a></li><li class="result"><a href="https://community.cloud.databricks.com/SHORTCUT_URL" class="" title="Shortcuts"><i class="fa fa- fa-fw"></i><span>Shortcuts</span></a></li></ul></div></ul>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="hidden">
      <div id="hidden" style="display: none;"></div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="history">
      <div id="history" style="display: none;"><div id="history-head">
  
  <h3 class="history-title">
    Recent Activity
    <i class="hide-recent-activity remove-button fa fa-remove fa-fw"></i>
  </h3>
  
</div>

<div id="history-list">
  <ul>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        A
      </div>
      <div class="history-item-action">
        <p class="user-name">apaul11@calstatela.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-01-25 23:51:14</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        A
      </div>
      <div class="history-item-action">
        <p class="user-name">apaul11@calstatela.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-01-25 23:50:42</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        A
      </div>
      <div class="history-item-action">
        <p class="user-name">apaul11@calstatela.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-01-25 23:47:51</p>
      </div>
    </li>
    
  </ul>
</div>
</div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="proxy-endpoints-conn-test-iframe">
      <div id="proxy-endpoints-conn-test-iframe" style="display: none;"><iframe src="IOWA%20-%20Linear%20regression%20(Revised)%20-%20Databricks%20Community%20Edition_files/proxy-endpoints-domain-conn-test.html" tabindex="-1" title="empty" class="hidden" width="0" height="0"></iframe></div>
    </uses-legacy-bootstrap>

    <uses-legacy-bootstrap data-wrapped-element-id="debugHelper">
      <div id="debugHelper" style="z-index: 1000; display: none; position: fixed; right: 190px; bottom: 0px;">
        <div id="debugRoute" style="position: fixed; right: 190px; bottom: 40px;"></div>
        <div id="debugCounters" style="color:var(--primary-text-color); position: fixed; right: 50px; bottom: 20px;"></div>
        <a href="https://community.cloud.databricks.com/ops/">[OPS]</a>
        <a href="https://community.cloud.databricks.com/ops/debug">Debug</a>
        <a href="https://community.cloud.databricks.com/ops/metrics">Metrics</a>
        <a href="https://community.cloud.databricks.com/ops/requests">Requests</a>
      </div>
    </uses-legacy-bootstrap>

    <!--
  This HTML file is a template.
  If you open it directly in the browser, you will see an empty page.

  You can add webfonts, meta tags, or analytics to this file.
  The build step will place the bundled scripts into the <body> tag.

  To begin the development, run `npm start` or `yarn start`.
  To create a production bundle, use `npm run build` or `yarn build`.
-->
  <script type="text/javascript" async="" src="IOWA%20-%20Linear%20regression%20(Revised)%20-%20Databricks%20Community%20Edition_files/heap-3428506230.js"></script><script type="text/javascript" src="IOWA%20-%20Linear%20regression%20(Revised)%20-%20Databricks%20Community%20Edition_files/metrics-graphics.js"></script><script type="text/javascript" src="IOWA%20-%20Linear%20regression%20(Revised)%20-%20Databricks%20Community%20Edition_files/main.js"></script>

<uses-legacy-bootstrap><div class="filebrowser-context-menu dropdown-menu"></div></uses-legacy-bootstrap><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip  rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 679px; top: 78px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow" style="left: 85.5667px;"></div><div class="rc-tooltip-inner">Run all cells in this notebook.</div></div></div></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip notebook-title-tooltip rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 0px; top: 39px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow"></div><div class="rc-tooltip-inner">Workspace/Users/apaul11@calstatela.edu/TestFolder/IOWA - Linear regression (Revised)</div></div></div></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip  rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 59px; top: 76px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow"></div><div class="rc-tooltip-inner">Not attached to a cluster. Select a cluster to attach.</div></div></div></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip  rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 1243.83px; top: 79px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow" style="left: 153.85px;"></div><div class="rc-tooltip-inner">View revision history for this notebook.</div></div></div></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip  rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 1122px; top: 79px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow" style="left: 157.45px;"></div><div class="rc-tooltip-inner"><span>Use the MLflow tracking API to record runs from this notebook.<a href="https://docs.databricks.com/applications/mlflow/tracking.html#tracking-machine-learning-training-runs" target="_blank" rel="noopener noreferrer">&nbsp;Learn more</a></span></div></div></div></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip  rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 924px; top: 79px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow" style="left: 157.467px;"></div><div class="rc-tooltip-inner">This notebook will be published publicly and anyone with the link can view it</div></div></div></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip  rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 1056px; top: 79px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow" style="left: 119.367px;"></div><div class="rc-tooltip-inner">View and add comments to this notebook.</div></div></div></div></div></body></html>